<!DOCTYPE html>
<html lang="eng">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Page Title</title>
    <link rel="stylesheet" href="../Assets/css/add_show.css">
</head>

<body>

    <div class="popup-content">

        <form id="movie-form">

            <label> Movie name:</label>
            <input type="text" id="mname" placeholder="Enter movie name">

            <label for="theatre_name">Theatre name :</label>
            <input type="text" id="thname" name="theatre_name" placeholder="Enter theatre Name..">
<!-- 
            <label for="theatre_name">Theatre address :</label>
            <input type="text" id="theadd" name="theatre_address" placeholder="Enter theatre address.."> -->

            <div class="show-frame">
               <label>Choose screen frame</label>
               <select id="screen-frame">
                   <option value="2D">2D </option>
                   <option value="3D">3D</option>
               </select>

               <div class="movie-lan">
                <label>Choose screen frame</label>
                <select id="movie-language">
                    <option value="Tamil">Tamil </option>
                    <option value="Telugu">Telugu</option>
                    <option value="Malayalam">Malayalam </option>
                    <option value="Hindi">Hindi</option>
                    <option value="Kanada">Kanada </option>
                </select>

            </div>

            <div class="show-date">
                <label>choose show date</label>
                <select id="show-date">
                    <option value="01">01</option>
                    <option value="02">02</option>
                    <option value="03">03</option>
                    <option value="04">04</option>
                    <option value="05">05</option>
                    <option value="06">06</option>
                    <option value="07">07</option>
                    <option value="08">08</option>
                    <option value="09">09</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                    <option value="13">13</option>
                    <option value="14">14</option>
                    <option value="15">15</option>
                    <option value="16">16</option>
                    <option value="17">17</option>
                    <option value="18">18</option>
                    <option value="19">19</option>
                    <option value="20">20</option>
                    <option value="21">21</option>
                    <option value="22">22</option>
                    <option value="23">23</option>
                    <option value="24">24</option>
                    <option value="25">25</option>
                    <option value="26">26</option>
                    <option value="27">27</option>
                    <option value="28">28</option>
                    <option value="29">29</option>
                    <option value="30">30</option>
                    <option value="31">31</option>
                </select>
            </div>

            <div class="show-month">
                <label>enter show month</label>
                <select id="show-month">
                    <option value="Jan">Jan</option>
                    <option value="Feb">Feb</option>
                    <option value="Mar">Mar</option>
                    <option value="Apr">Apr</option>
                    <option value="May">May</option>
                    <option value="Jun">Jun</option>
                    <option value="Jul">Jul</option>
                    <option value="Aug">Aug</option>
                    <option value="Sep">Sep</option>
                    <option value="Oct">Oct</option>
                    <option value="Nov">Nov</option>
                    <option value="Dec">Dec</option>
                </select>
            </div>

            <div class="show-times">
                <label>choose show times</label>
                <div class="button">

                    <select id="show-times-option">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                        <option value="12">12</option>
                        <option value="13">13</option>
                        <option value="14">14</option>
                        <option value="15">15</option>
                        <option value="16">16</option>
                        <option value="17">17</option>
                        <option value="18">18</option>
                        <option value="19">19</option>
                        <option value="20">20</option>
                        <option value="21">21</option>
                        <option value="22">22</option>
                        <option value="23">23</option>
                        <option value="24">24</option>
                        <option value="25">25</option>
                        <option value="26">26</option>
                        <option value="27">27</option>
                        <option value="28">28</option>
                        <option value="29">29</option>
                        <option value="30">30</option>

                    </select>
                    <button id="show-times-option-button">Add show</button>

                </div>

                <label>enter show times</label>
                <div class="shows" id="shows">

                </div>
            </div>

            <div class="tickets_cost">

                <label>Seat cost</label>

                <div class="cost_seat">
                    <h3>Budget seat</h3>
<input type="text" id="budget_cost" inputmode="numeric">
                </div>

                <div class="cost_seat">
                    <h3>Premium seat</h3>
<input type="text" id="premium_cost" inputmode="numeric">
                </div>
            </div>
            <button> submit</button>
    </div>

    </form>

    <script>
        const show_times_option_button = document.getElementById("show-times-option-button")
        show_times_option_button.addEventListener("click", e => {
            e.preventDefault()
            const show_times_option = document.getElementById("show-times-option").value

            option = show_times_option

            for (i = 0; i < option; i++) {
                const shows = document.getElementById("shows")

                const time_input = document.createElement("input");
                time_input.setAttribute("class", "shows_timing");
                time_input.setAttribute("type", "time");
                shows.appendChild(time_input);
            }
        });

        const form_control = document.getElementById("movie-form");
        function formsubmit() {  

            const movie_name = document.getElementById("mname").value;
            const theatre_name = document.getElementById("thname").value;
            // const theatre_address=document.getElementById("theadd").value;
            const screen_frame=document.getElementById("screen-frame").value;
            const movie_language=document.getElementById("movie-language").value;
            const show_date = document.getElementById("show-date").value;
            const show_month = document.getElementById("show-month").value;
            const show_times = document.querySelectorAll(".shows_timing");
            const budget_cost = document.getElementById("budget_cost").value;
            const premium_cost = document.getElementById("premium_cost").value;
            
            const show_timing_values = [];

            show_times.forEach((e, ind) => {
                // console.log(e.value.slice(0, 2));
                // console.log(e.value.slice(2,5));
                
                if (e.value.slice(0, 2) > 12) {
                    let new_hour = e.value.slice(0, 2) - 12
                    const old_min = e.value.slice(2, 5)
                    if(new_hour<10){
                        new_hour="0"+new_hour
                    }
                    
        
                    const new_time = `${new_hour + old_min  } PM`
                    show_timing_values.push(new_time)

                    console.log(new_hour);

                }
                 else if (e.value.slice(0, 2) == 12) {
                    const new_time = `${show_times[ind].value  } PM`
                    show_timing_values.push(new_time)
                }

                else {
                    const new_time = `${show_times[ind].value  } AM`
                    show_timing_values.push(new_time)

                }

                // console.log(show_times[ind].value,"efvd");
            })
            console.log(show_timing_values);

            // console.log(show_times.length);
            const show_timing = [];
            for (let j = 0; j < show_times.length; j++) {
                show_timing.push(show_times[j].value)
            }

            const theatres = {

        name: {
            movie_name,
            theatre_name,
            // theatre_address:theatre_address,

        },
        show_times: show_timing_values,
        show_date,
        screen_frame,
        movie_language,
        show_month,
        budget_cost,
        premium_cost,
        status: true,
    }

            const details_theatre = JSON.parse(localStorage.getItem("show_details")) ?? [];

            details_theatre.push(theatres);
  
            // alert('theatre list created successfully')

            localStorage.setItem("show_details", JSON.stringify(details_theatre))
        };

        form_control.addEventListener("submit", e => {
            e.preventDefault();

            formsubmit()
        })
    </script>

</body>

</html>